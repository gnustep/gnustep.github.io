
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.3 - New Time Zone Dialog &#8212; GNUstep</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Guides/App/3_TimeMachine/3.3';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="3.4 - Multiple Clocks" href="3.4.html" />
    <link rel="prev" title="3.2 - Analog Clock" href="3.2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">GNUstep</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    Guides
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../Manuals/index.html">
    Manuals
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../APIRefs/index.html">
    API references
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../About/index.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../Showcase/index.html">
    Showcase
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    Guides
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../Manuals/index.html">
    Manuals
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../APIRefs/index.html">
    API references
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../About/index.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../Showcase/index.html">
    Showcase
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Building Apps with GORM</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../1_Intro/index.html">1 - Introduction to GNUstep Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../2_Convertor/index.html">2 - Convertor</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../2_Convertor/2.1.html">2.1 - Designing the UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2_Convertor/2.2.html">2.2 - Outlets and Actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2_Convertor/2.3.html">2.3 - Adding the Code</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="index.html">3 - TimeMachine</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="3.1.html">3.1 - A Basic Clock</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.2.html">3.2 - Analog Clock</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">3.3 - New Time Zone Dialog</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.4.html">3.4 - Multiple Clocks</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../4_Money/index.html">4 - Money</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../4_Money/4.1.html">4.1 - The Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../4_Money/4.2.html">4.2 - Document Editor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../4_Money/4.3.html">4.3 - Load and Save</a></li>
<li class="toctree-l3"><a class="reference internal" href="../4_Money/4.4.html">4.4 - Drag and Drop</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../5_Overview/index.html">5 - Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6_LunarCalendar/index.html">6 - LunarCalendar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7_NSLookupService/index.html">7 - NSLookupService</a></li>
<li class="toctree-l2"><a class="reference internal" href="../HelpfulWebsites.html">Helpful Websites</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../AppsWithCodeOnly/index.html">Building Apps from Code Only</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/index.html">First Steps in GNUstep GUI Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/1_SharedApplication.html">1 - The shared application object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/2_AppIcon.html">2 - Setting your application’s icon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/3_Menus.html">3 - Menus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/4_PointsSizesRectangles.html">4 - Points, Sizes and Rectangles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/5_Windows.html">5 - Adding a Window to your Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/6_Buttons.html">6 - Adding a Button in the Window</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Install/index.html">Installation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Install/Linux.html">Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Install/Windows.html">Windows</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">Guides</a></li>
    
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Building Apps with GORM</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">3 - TimeMachine</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">3.3 - New Time Zone Dialog</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="new-time-zone-dialog">
<h1>3.3 - New Time Zone Dialog<a class="headerlink" href="#new-time-zone-dialog" title="Link to this heading">#</a></h1>
<p>In this section, we will create a dialog and add it to our clock application.</p>
<p><img alt="" src="../../../_images/Panel-02.jpg" /></p>
<p>You will learn:</p>
<section id="creating-a-panel">
<h2>Creating a Panel<a class="headerlink" href="#creating-a-panel" title="Link to this heading">#</a></h2>
<p>A Panel is a special kind of window. Read the Cocoa document for more
details: <a class="reference external" href="https://web.archive.org/web/20010606130438if_/https://developer.apple.com/techpubs/macosx/Cocoa/TasksAndConcepts/ProgrammingTopics/WinPanel/index.html"><em>Windows and
Panels</em></a>.</p>
<p>Since I have a clock already, I want to know the time in different time
zones. My idea is that when I click the title of the <code class="docutils literal notranslate"><span class="pre">NSBox</span></code>, a panel will
show up and ask the time zone. Once the time zone is inputted, it will
display the time in that area. Since <code class="docutils literal notranslate"><span class="pre">NSPanel</span></code> is a subclass of <code class="docutils literal notranslate"><span class="pre">NSWindow</span></code>,
the usage of <code class="docutils literal notranslate"><span class="pre">NSPanel</span></code> is similar to <code class="docutils literal notranslate"><span class="pre">NSWindow</span></code>. Again, I need a
“controller” to control the “view”, which is <code class="docutils literal notranslate"><span class="pre">NSPanel</span></code> in this case.
The “view” is generated by Gorm, and I need to write the “controller” by
myself. In this example, I’ll show how to load the gorm file. There are
many built-in panel in GNUstep. I also use one in this example.</p>
<p>First, we need to build the interface for the panel. Open Gorm, and choose
the menu item “Document → New Module → New Empty”. Look at the palettes.
There is one for “Panel”.</p>
<p><span id="AEN734"></span></p>
<p><strong>Figure 4-22. Panel in Gorm</strong></p>
<p><img alt="" src="../../../_images/Panel-01.jpg" /></p>
<p>Drag the Panel out of <u>Palettes</u>. Build the interface as below.</p>
<p><span id="AEN740"></span></p>
<p><strong>Figure 4-23. Interface of time zone panel</strong></p>
<p><img alt="" src="../../../_images/Panel-02.jpg" /></p>
<p>You can change the size of panel in the inspector.
Here are the attributes of the panel.</p>
<p><span id="AEN746"></span></p>
<p><strong>Figure 4-24. Panel attributes</strong></p>
<p><img alt="" src="../../../_images/Panel-03.jpg" /></p>
</section>
<section id="controlling-the-panel">
<h2>Controlling the panel<a class="headerlink" href="#controlling-the-panel" title="Link to this heading">#</a></h2>
<p>Now, I have the “view”. Then where is the “controller”? Generally, you can
write a new class as the controller of this view, but this is a small
program, so you don’t have to write a class just for the controller.
So I decide to use the class <code class="docutils literal notranslate"><span class="pre">TimeView</span></code> as the controller
for this panel. So <code class="docutils literal notranslate"><span class="pre">TimeView</span></code> acts as the custom view for that
main window interface, and as the controller for the panel. Since
<code class="docutils literal notranslate"><span class="pre">TimeView</span></code> is the controller of this panel, I need to connect the
outlets and actions. Therefore, I need to create the class <code class="docutils literal notranslate"><span class="pre">TimeView</span></code>
again in this gorm file, even though there is already one in
TimeMachine.gorm file.</p>
<div class="admonition-editor-s-note admonition">
<p class="admonition-title">Editor’s note</p>
<p>This seems like a bad idea, but changing it would require a lot of refactoring of this tutorial.</p>
</div>
<p>You already know how to create the class <code class="docutils literal notranslate"><span class="pre">TimeView</span></code>. I add two outlets,
<code class="docutils literal notranslate"><span class="pre">zonePanel</span></code> and <code class="docutils literal notranslate"><span class="pre">zoneField</span></code>, and two actions, <code class="docutils literal notranslate"><span class="pre">okAction:</span></code> and
<code class="docutils literal notranslate"><span class="pre">cancelAction:</span></code>.</p>
<p><span id="AEN753"></span></p>
<p><strong>Figure 4-25. Outlets for time zone panel</strong></p>
<p><img alt="" src="../../../_images/Panel-05.jpg" /></p>
<p><span id="AEN758"></span></p>
<p><strong>Figure 4-26. Actions for time zone panel</strong></p>
<p><img alt="" src="../../../_images/Panel-04.jpg" /></p>
<p>But rather than creating an instance to connect to the panel, let’s set the
owner of this panel to our <code class="docutils literal notranslate"><span class="pre">TimeView</span></code>. This reduces the amount of instances in our project.</p>
<p>Select the NSOwner in Gorm main window, then select class <code class="docutils literal notranslate"><span class="pre">TimeView</span></code> in
the <u>Attributes</u> tab of the inspector.</p>
<p><span id="AEN765"></span></p>
<p><strong>Figure 4-27. Set NSOwner to TimeView class</strong></p>
<p><img alt="" src="../../../_images/Panel-06.jpg" /></p>
<p><img alt="" src="../../../_images/Panel-07.jpg" /></p>
<p>By this way, I can connect the panel to the <code class="docutils literal notranslate"><span class="pre">NSOwner</span></code>, which is an
instance of class <code class="docutils literal notranslate"><span class="pre">TimeView</span></code>. Connect the two buttons to the actions in
NSOwner, the outlet <code class="docutils literal notranslate"><span class="pre">zoneField</span></code> to the <code class="docutils literal notranslate"><span class="pre">NSTextField</span></code> in the panel, and the
outlet <code class="docutils literal notranslate"><span class="pre">zonePanel</span></code> to the panel. Pay attention to how the <code class="docutils literal notranslate"><span class="pre">NSOwner</span></code>
connects to the panel.</p>
<p><span id="AEN774"></span></p>
<p><strong>Figure 4-28. Connect outlet</strong></p>
<p><img alt="" src="../../../_images/Panel-08.jpg" /></p>
<p><img alt="" src="../../../_images/Panel-09.jpg" /></p>
<p>Save this interface as <code class="docutils literal notranslate"><span class="pre">TimeZonePanel.gorm</span></code>, and quit Gorm. Don’t
generate the files for class <code class="docutils literal notranslate"><span class="pre">TimeView</span></code> because I already have the
files. GNUstep can figure out where the classes are and where the
outlets/actions are.</p>
<section id="the-code">
<h3>The code<a class="headerlink" href="#the-code" title="Link to this heading">#</a></h3>
<p>Now, I need to add the new outlets and actions into the files of
<code class="docutils literal notranslate"><span class="pre">TimeView</span></code>. Here is the header.</p>
<p><code class="docutils literal notranslate"><span class="pre">TimeView.h:</span></code></p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="cp">#import &lt;AppKit/AppKit.h&gt;</span>
<span class="cp">#import &quot;ClockView.h&quot;</span>

<span class="k">@interface</span> <span class="nc">TimeView</span> : <span class="nc">NSControl</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">id</span><span class="w"> </span><span class="n">zonePanel</span><span class="p">;</span>
<span class="w">    </span><span class="kt">id</span><span class="w"> </span><span class="n">zoneField</span><span class="p">;</span>
<span class="w">    </span><span class="n">NSBox</span><span class="o">*</span><span class="w"> </span><span class="n">box</span><span class="p">;</span>
<span class="w">    </span><span class="n">NSTextField</span><span class="w"> </span><span class="o">*</span><span class="n">labelDate</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">labelTime</span><span class="p">;</span>
<span class="w">    </span><span class="n">NSTextField</span><span class="w"> </span><span class="o">*</span><span class="n">localDate</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">localTime</span><span class="p">;</span>
<span class="w">    </span><span class="n">NSCalendarDate</span><span class="o">*</span><span class="w"> </span><span class="n">date</span><span class="p">;</span>
<span class="w">    </span><span class="n">ClockView</span><span class="o">*</span><span class="w"> </span><span class="n">clockView</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="n">NSCalendarDate</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nf">date</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">setDate:</span><span class="w"> </span><span class="p">(</span><span class="n">NSCalendarDate</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">date</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">okAction:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">sender</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">cancelAction:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">sender</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
</div>
<p>I add the outlets and actions by myself.</p>
<p><code class="docutils literal notranslate"><span class="pre">TimeView.m:</span></code></p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">mouseDown:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSEvent</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">event</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">NSRect</span><span class="w"> </span><span class="n">titleFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">box</span><span class="w"> </span><span class="n">titleRect</span><span class="p">];</span>
<span class="w">    </span><span class="n">NSPoint</span><span class="w"> </span><span class="n">windowLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">event</span><span class="w"> </span><span class="n">locationInWindow</span><span class="p">];</span>
<span class="w">    </span><span class="n">NSPoint</span><span class="w"> </span><span class="n">viewLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">convertPoint</span><span class="o">:</span><span class="w"> </span><span class="n">windowLocation</span><span class="w"> </span><span class="n">fromView</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">superview</span><span class="p">]];</span>
<span class="w">    </span><span class="kt">BOOL</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NSMouseInRect</span><span class="p">(</span><span class="n">viewLocation</span><span class="p">,</span><span class="w"> </span><span class="n">titleFrame</span><span class="p">,</span><span class="w"> </span><span class="nb">NO</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">YES</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">[</span><span class="bp">NSBundle</span><span class="w"> </span><span class="n">loadNibNamed</span><span class="o">:</span><span class="w"> </span><span class="s">@&quot;TimeZonePanel.gorm&quot;</span><span class="w"> </span><span class="n">owner</span><span class="o">:</span><span class="w"> </span><span class="nb">self</span><span class="p">];</span><span class="w"> </span>
<span class="w">        </span><span class="p">[</span><span class="n">NSApp</span><span class="w"> </span><span class="n">runModalForWindow</span><span class="o">:</span><span class="w"> </span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">zonePanel</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">-mouseDown:</span></code> is called when mouse is clicked within this view.
Here, we calculate whether the mouse is clicked in the area of the title
of the <code class="docutils literal notranslate"><span class="pre">NSBox</span></code>. If so, we use <code class="docutils literal notranslate"><span class="pre">[NSBundle</span> <span class="pre">loadNibNamed:</span> <span class="pre">owner:]</span></code> to load the
window, and <code class="docutils literal notranslate"><span class="pre">[NSApp</span> <span class="pre">runModalForWindow]</span></code> to display it. Read Cocoa’s
document about “<a class="reference external" href="http://developer.apple.com/techpubs/macosx/Cocoa/TasksAndConcepts/ProgrammingTopics/WinPanel/Concepts/UsingModalWindows.html#CJBEADBA"><em>How Modal Windows
Work</em></a>”.</p>
<p>Now, I just need to finish the actions part in <code class="docutils literal notranslate"><span class="pre">TimeView.m</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">TimeView.m:</span></code></p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">cancelAction:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">sender</span>
<span class="p">{</span>
<span class="w">    </span><span class="p">[</span><span class="n">NSApp</span><span class="w"> </span><span class="n">abortModal</span><span class="p">];</span>
<span class="w">    </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">zonePanel</span><span class="w"> </span><span class="n">close</span><span class="p">];</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">okAction:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">sender</span>
<span class="p">{</span>
<span class="w">    </span><span class="bp">NSTimeZone</span><span class="o">*</span><span class="w"> </span><span class="n">tempZone</span><span class="p">;</span>
<span class="w">    </span><span class="n">tempZone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSTimeZone</span><span class="w"> </span><span class="n">timeZoneWithName</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">zoneField</span><span class="w"> </span><span class="n">stringValue</span><span class="p">]];</span>
<span class="w">    </span><span class="p">[</span><span class="n">NSApp</span><span class="w"> </span><span class="n">stopModal</span><span class="p">];</span>
<span class="w">    </span><span class="p">[</span><span class="n">zonePanel</span><span class="w"> </span><span class="n">close</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tempZone</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">NSRunAlertPanel</span><span class="p">(</span><span class="s">@&quot;Warning!&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="s">@&quot;Wrong Time Zone !!&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="s">@&quot;OK&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">nil</span><span class="p">,</span><span class="w"> </span><span class="nb">nil</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">[</span><span class="n">date</span><span class="w"> </span><span class="n">setTimeZone</span><span class="o">:</span><span class="w"> </span><span class="n">tempZone</span><span class="p">];</span>
<span class="w">        </span><span class="p">[</span><span class="n">box</span><span class="w"> </span><span class="n">setTitle</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">tempZone</span><span class="w"> </span><span class="n">description</span><span class="p">]];</span>
<span class="w">        </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">setDate</span><span class="o">:</span><span class="w"> </span><span class="n">date</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In method <code class="docutils literal notranslate"><span class="pre">-okAction:</span></code>, I use a built-in panel, <code class="docutils literal notranslate"><span class="pre">NSRunAlertPanel</span></code>. There are
several built-in panels in GNUstep ready to use. Now, you can display
the current time in different time zone.</p>
</section>
</section>
<section id="better-keyboard-access">
<h2>Better keyboard access<a class="headerlink" href="#better-keyboard-access" title="Link to this heading">#</a></h2>
<p>It is inconvenient to use this pop-up panel because you have to click
the <code class="docutils literal notranslate"><span class="pre">NSTextField</span></code> before typing. Sometimes, it is more convenient to
control the user interface via keyboard rather than mouse.</p>
<p>When a window pop-up, it is the “First Responder” – the first object
to receive events and keypresses. But usually we want some
other objects in this window to receive the keypresses. Therefore, we need
to change the “first responder” of this window by
using <code class="docutils literal notranslate"><span class="pre">[NSWindow</span> <span class="pre">makeFirstResponder:]</span></code>.</p>
<p>When I want to use <kbd>Tab</kbd> key to switch between different views in the
window, you need to assign the <code class="docutils literal notranslate"><span class="pre">nextKeyView</span></code> to the next view when the <kbd>Tab</kbd>
key is pressed so that the Application Kit knows where the responder should
be.</p>
<p>Finally, when I finish typing in the <code class="docutils literal notranslate"><span class="pre">NSTextField</span></code>, I want to hit the
<kbd>Return</kbd> key to click <button>OK</button> so that I
don’t need to move my hand out of the keyboard. In this case, since
<code class="docutils literal notranslate"><span class="pre">NSTextField</span></code> is also a subclass of <code class="docutils literal notranslate"><span class="pre">NSControl</span></code>, I can set the target and
action of <code class="docutils literal notranslate"><span class="pre">NSTextField</span></code> to be the same as the <code class="docutils literal notranslate"><span class="pre">NSButton</span></code> <button>OK</button>. Therefore, when I hit <kbd>Return</kbd>, it is equivalent to clicking on the <button>OK</button> button.</p>
<p>These are small tune-ups for the application, but it makes it easier to use the application.</p>
<p>First, let’s set the “first responder” of the window to the
NSTextField:</p>
<p><code class="docutils literal notranslate"><span class="pre">TimeView.m:</span></code></p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">mouseDown:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSEvent</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">event</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">NSRect</span><span class="w"> </span><span class="n">titleFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">box</span><span class="w"> </span><span class="n">titleRect</span><span class="p">];</span>
<span class="w">    </span><span class="n">NSPoint</span><span class="w"> </span><span class="n">windowLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">event</span><span class="w"> </span><span class="n">locationInWindow</span><span class="p">];</span>
<span class="w">    </span><span class="n">NSPoint</span><span class="w"> </span><span class="n">viewLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">convertPoint</span><span class="o">:</span><span class="w"> </span><span class="n">windowLocation</span><span class="w"> </span><span class="n">fromView</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">superview</span><span class="p">]];</span>
<span class="w">    </span><span class="kt">BOOL</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NSMouseInRect</span><span class="p">(</span><span class="n">viewLocation</span><span class="p">,</span><span class="w"> </span><span class="n">titleFrame</span><span class="p">,</span><span class="w"> </span><span class="nb">NO</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">YES</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">[</span><span class="bp">NSBundle</span><span class="w"> </span><span class="n">loadNibNamed</span><span class="o">:</span><span class="w"> </span><span class="s">@&quot;TimeZonePanel.gorm&quot;</span><span class="w"> </span><span class="n">owner</span><span class="o">:</span><span class="w"> </span><span class="nb">self</span><span class="p">];</span><span class="w"> </span>
<span class="w">        </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">zonePanel</span><span class="w"> </span><span class="n">makeFirstResponder</span><span class="o">:</span><span class="w"> </span><span class="n">zoneField</span><span class="p">];</span>
<span class="w">        </span><span class="p">[</span><span class="n">NSApp</span><span class="w"> </span><span class="n">runModalForWindow</span><span class="o">:</span><span class="w"> </span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">zonePanel</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Only one line is enough. Now, when this panel shows up, the cursor will
automatically be in the <code class="docutils literal notranslate"><span class="pre">NSTextField</span></code>.</p>
<p>Second, let’s set the target and action of <code class="docutils literal notranslate"><span class="pre">NSTextField</span></code> to be the same as the <code class="docutils literal notranslate"><span class="pre">NSButton</span></code> <button>OK</button>. Open the <code class="docutils literal notranslate"><span class="pre">TimeZonePanel.gorm</span></code>, and connect the <code class="docutils literal notranslate"><span class="pre">NSTextField</span></code> to the method <code class="docutils literal notranslate"><span class="pre">-okAction:</span></code> of the <code class="docutils literal notranslate"><span class="pre">NSOwner</span></code>. That’s it. Whenever you hit the <kbd>Return</kbd> key in the <code class="docutils literal notranslate"><span class="pre">NSTextField</span></code>, the method <code class="docutils literal notranslate"><span class="pre">-okAction:</span></code> is
called.</p>
<p><span id="AEN814"></span></p>
<p><strong>Figure 4-29. Connection NSTextField action</strong></p>
<p><img alt="" src="../../../_images/Panel-10.jpg" /></p>
<p><img alt="" src="../../../_images/Panel-11.jpg" /></p>
<p><img alt="" src="../../../_images/Panel-12.jpg" /></p>
<p>Third, we need to connect the <code class="docutils literal notranslate"><span class="pre">nextKeyView</span></code> outlet between the views in
the window. I’ll connect the <code class="docutils literal notranslate"><span class="pre">nextKeyView</span></code> of <code class="docutils literal notranslate"><span class="pre">NSTextField</span></code> to the <code class="docutils literal notranslate"><span class="pre">NSButton</span></code> <button>OK</button>, the <code class="docutils literal notranslate"><span class="pre">nextKeyView</span></code> outlet of the <code class="docutils literal notranslate"><span class="pre">NSButton</span></code> <button>OK</button> to the <code class="docutils literal notranslate"><span class="pre">NSButton</span></code> <button>Cancel</button>,
and the <code class="docutils literal notranslate"><span class="pre">nextKeyView</span></code> outlet of the <code class="docutils literal notranslate"><span class="pre">NSButton</span></code> <button>Cancel</button> to the <code class="docutils literal notranslate"><span class="pre">NSTextField</span></code>. By
doing that, I can switch between these views using the <kbd>Tab</kbd> key. Here, I just
show how the <code class="docutils literal notranslate"><span class="pre">nextKeyView</span></code> of <code class="docutils literal notranslate"><span class="pre">NSTextField</span></code> connects to the <code class="docutils literal notranslate"><span class="pre">NSButton</span></code> <button>OK</button>.</p>
<p><span id="AEN826"></span></p>
<p><strong>Figure 4-30. Connect nextKeyView</strong></p>
<p><img alt="" src="../../../_images/Panel-13.jpg" /></p>
<p><img alt="" src="../../../_images/Panel-14.jpg" /></p>
<p>Source code:
<a class="reference external" href="http://gnustep.made-it.com/GSPT/Panel/Panel-src.tar.gz">Panel-src.tar.gz</a>.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3.2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">3.2 - Analog Clock</p>
      </div>
    </a>
    <a class="right-next"
       href="3.4.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">3.4 - Multiple Clocks</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-panel">Creating a Panel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#controlling-the-panel">Controlling the panel</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-code">The code</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#better-keyboard-access">Better keyboard access</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../../_sources/Guides/App/3_TimeMachine/3.3.md.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, GNUstep contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>